# Benchmark Run: 2025-12-30 (v6)

## Configuration

- **Repository**: Pith (self-test)
- **Size**: 24 files, ~11.8k lines
- **Pith version**: 7a3ce04
- **Model**: qwen/qwen-turbo
- **Tasks**: 5 (one per category)

## Pipeline Metrics

| Stage | Time | Notes |
|-------|------|-------|
| Extraction | 8.9s | 29 files extracted |
| Build | 2.2s | 100 nodes created (29 file, 61 function, 10 module) |
| Generation | 169.7s | 39 nodes with prose |
| **Total** | ~181s (~3 min) | |

- Nodes created: 29 file, 61 function, 10 module (100 total)
- Nodes with prose: 39 (files + modules only)
- Estimated cost: ~$0.50-1.00 (qwen-turbo)

---

## Task Results

### Task A1: Architecture
**Question**: "What are the main components of this codebase and how do they interact?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 4/5 | 5/5 |
| Completeness | 3/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 3/5 | 5/5 |
| **Total** | **19/25** | **24/25** |

- **Winner**: Control
- **Pith tokens**: ~2,800 (7 modules)
- **Control tokens**: ~4,500
- **Notes**: Pith provided good module summaries with purpose descriptions, data flow overview, and quick start examples. Control identified 8 main components with specific line numbers (CLI:1-738, Extractor modules, Builder:109-750, Generator:80-860, API:34-667, DB:1-52, Config:64-111, Errors:1-123), traced complete data flow with 12+ transformation points, mapped import chains and critical dependencies.

---

### Task B1: Specific Behavior
**Question**: "How does the extraction cache determine if a file needs re-extraction?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 4/5 | 5/5 |
| Completeness | 3/5 | 5/5 |
| Accuracy | 5/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 3/5 | 5/5 |
| **Total** | **20/25** | **24/25** |

- **Winner**: Control
- **Pith tokens**: ~1,800
- **Control tokens**: ~2,200
- **Notes**: Pith showed cache.ts functions with signatures (getFileHash lines 26-30, shouldExtract lines 85-100, loadExtractionCache lines 38-58), mentioned hash comparison logic. Control provided complete flow: SHA-256 hash computation at cache.ts:26-30, shouldExtract logic at lines 85-100 (new file → true, hash mismatch → true), CLI integration at cli:143,154-159,217-220,236, and --force flag bypass.

---

### Task R1: Cross-Module Relationship
**Question**: "What files would be affected if I changed the WikiNode interface?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 3/5 | 5/5 |
| Completeness | 2/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 3/5 |
| Actionability | 2/5 | 5/5 |
| **Total** | **16/25** | **23/25** |

- **Winner**: Control
- **Pith tokens**: ~2,500
- **Control tokens**: ~3,800
- **Notes**: Pith showed WikiNode is in builder/index.ts with "Warning: Widely used (8 files depend on this)" and listed dependents field. Control mapped 62 specific locations across 4 core modules: builder (lines 69-102 definition, 109-243 node builders, 332-521 operations), generator (lines 1,80,128,263,493,567,720,752-860), api (lines 2,20,34-105,113-446), cli (lines 31,316-451), plus 4 test files with 70+ fixtures.

---

### Task D1: Debugging
**Question**: "Generation completes but some nodes have empty prose. What should I investigate?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 3/5 | 5/5 |
| Completeness | 2/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 2/5 | 5/5 |
| **Total** | **16/25** | **24/25** |

- **Winner**: Control
- **Pith tokens**: ~3,200
- **Control tokens**: ~4,000
- **Notes**: Pith mentioned generator module creates prose, listed gotchas about LLM service initialization and environment variables. Control identified 6 root causes: (1) JSON parsing failure at generator:334-356, (2) Missing required fields at generator:359-363, (3) Empty string values passing validation (no check for empty strings!), (4) LLM API failures with retry logic at generator:687-704, (5) Child summary filtering at generator:844-846, (6) Response coercion issues. Provided 6 specific debug steps.

---

### Task M1: Modification
**Question**: "How would I add support for JavaScript (.js) files in addition to TypeScript?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 2/5 | 5/5 |
| Completeness | 1/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 1/5 | 5/5 |
| **Total** | **13/25** | **24/25** |

- **Winner**: Control
- **Pith tokens**: ~2,000
- **Control tokens**: ~4,200
- **Notes**: Pith described extractor module as "analyzing TypeScript files" with no modification guidance. Control identified 7+ locations needing changes: ast.ts:256 (extension filter), config:45-48 (patterns), builder:532,574-607 (test detection), builder:412,423 (import resolution), builder:266 (module detection), cli:85,122 (descriptions). Provided 9-phase implementation plan with parser dependency recommendations (@babel/parser, acorn, oxc_parser).

---

## Summary

### Overall Scores

| Metric | Pith | Control |
|--------|------|---------|
| **Average score** | **16.8/25** | **23.8/25** |
| Win/Loss/Tie | 0-5-0 | 5-0-0 |

### Score Breakdown by Category

| Category | Pith | Control | Gap |
|----------|------|---------|-----|
| Architecture (A1) | 19/25 | 24/25 | -5 |
| Behavior (B1) | 20/25 | 24/25 | -4 |
| Relationship (R1) | 16/25 | 23/25 | -7 |
| Debugging (D1) | 16/25 | 24/25 | -8 |
| Modification (M1) | 13/25 | 24/25 | -11 |

### Score Breakdown by Criterion

| Criterion | Pith Avg | Control Avg | Gap |
|-----------|----------|-------------|-----|
| Relevance | 3.2 | 5.0 | -1.8 |
| Completeness | 2.2 | 5.0 | **-2.8** |
| Accuracy | 4.2 | 5.0 | -0.8 |
| Efficiency | 5.0 | 3.8 | **+1.2** |
| Actionability | 2.2 | 5.0 | **-2.8** |

### Comparison to Previous Runs

| Metric | v4 (5 tasks) | v5 (15 tasks) | v6 (5 tasks) |
|--------|--------------|---------------|--------------|
| Pith Average | 14.4/25 | 15.5/25 | **16.8/25** |
| Control Average | 23.8/25 | 23.9/25 | **23.8/25** |
| Pith Win Rate | 0% | 0% | **0%** |

**Note**: v6 shows slight improvement in Pith average (16.8 vs 15.5), likely due to task selection focusing on areas where Pith performs better (architecture, behavior) vs v5's broader coverage.

---

## Information Gap Analysis

### Pith Advantages

| Information Type | Pith | Control | Notes |
|------------------|------|---------|-------|
| Conciseness | ✅ 5.0/5 | 3.8/5 | Pith prose is focused |
| Token efficiency | ~2.5k avg | ~3.7k avg | Pith uses ~32% fewer tokens |
| Retrieval speed | <100ms | 30-60s | Pre-built wiki vs exploration |
| Git metadata | ✅ | ❌ | Commits, authors, dates |
| Fan-in/out metrics | ✅ | ❌ | Dependency counts |
| Quick start examples | ✅ | ❌ | Code snippets for usage |

### Control Advantages

| Information Type | Pith | Control | Gap |
|------------------|------|---------|-----|
| Line number references | ⚠️ Listed | ✅ Contextual | High |
| Cross-file tracing | ❌ | ✅ Complete | **Critical** |
| Implementation guides | ❌ | ✅ Step-by-step | **Critical** |
| Consumer mapping | ⚠️ Dependents count | ✅ 62+ refs | **Critical** |
| Debug flow analysis | ❌ | ✅ Root cause list | **Critical** |
| Change impact details | ⚠️ Warning only | ✅ All locations | High |
| Specific values | ❌ | ✅ Exact constants | High |

---

## Concrete Examples

### Example: Task R1 (WikiNode Impact)

| Detail | Pith Said | Control Said | Gap |
|--------|-----------|--------------|-----|
| Where defined? | "builder/index.ts" | "builder/index.ts:69-102" | **Line numbers** |
| How many consumers? | "8 files depend on this" | "62 specific locations across 4 modules + 4 test files" | **Specific locations** |
| Which functions? | Not mentioned | "buildFileNode, buildFunctionNode, buildModuleNode, computeMetadata, buildImpactTree..." | **Function-level detail** |
| Test fixtures? | Not mentioned | "Lines 35-100+ in builder.test.ts, api.test.ts, generator.test.ts, cli.test.ts" | **Test coverage** |

### Example: Task D1 (Empty Prose Debugging)

| Detail | Pith Said | Control Said | Gap |
|--------|-----------|--------------|-----|
| Where to look? | "generator module creates prose" | "6 specific causes with line numbers" | **Root cause analysis** |
| Validation issue? | "LLM service must be initialized" | "No validation for empty strings at generator:359-363 - likely root cause!" | **Specific bug identification** |
| Debug steps? | Not mentioned | "6-step debug guide: verbose logging, DB inspection, add logging, test API, check file types, validate prompts" | **Actionable guidance** |

---

## Key Conclusions

### 1. Task Type Sensitivity
Pith performs best on **orientation tasks** (architecture, behavior) where module summaries provide value:
- A1 (Architecture): 19/25 - Pith's module descriptions align well
- B1 (Behavior): 20/25 - Function signatures and gotchas help

Pith struggles with **implementation tasks** (debugging, modification) requiring cross-file analysis:
- M1 (Modification): 13/25 - No implementation guidance
- D1 (Debugging): 16/25 - No root cause analysis

### 2. Consistent Gap Pattern
Across all 5 tasks, Control provides:
- **Specific line numbers** in context (not just listed)
- **Cross-file tracing** of data flow and dependencies
- **Actionable next steps** for the specific task
- **Complete consumer/impact mapping**

### 3. Pith's Value Proposition
Despite lower scores, Pith provides:
- **32% token efficiency** (faster context injection)
- **Sub-second retrieval** (no exploration overhead)
- **Unique metadata** (git history, fan-in/out, age)
- **Consistent prose format** (predictable structure)

---

## Recommendations

### For Pith Development

1. **Add change impact sections** - When a file has high fan-in, include specific consumer locations
2. **Enhance debugging hints** - Add root cause analysis and debug steps to gotchas
3. **Include modification guidance** - For widely-used interfaces, list required change locations
4. **Cross-reference specific values** - Include important constants (timeouts, limits) in prose

### For Benchmark Methodology

1. **Use balanced task mix** - Include both orientation and implementation tasks
2. **Track per-criterion scores** - Completeness and Actionability are key differentiators
3. **Compare token efficiency** - Pith's 32% advantage matters for context windows

---

## Revision History

| Date | Change | Author |
|------|--------|--------|
| 2025-12-30 | v6 benchmark with 5 tasks, full methodology | Claude |
