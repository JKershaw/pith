# Benchmark Run: 2025-12-30 (Third Run)

## Configuration

- **Repository**: Pith (self-test)
- **Size**: 29 files, ~10.5k lines
- **Pith version**: d2240b9 (after PR #15 merge with improved LLM prompts)
- **Model**: qwen/qwen-turbo

## Pipeline Metrics

| Stage | Time | Notes |
|-------|------|-------|
| Extraction | 7.2s | 29 files extracted |
| Build | 0.9s | 96 nodes created |
| Generation | 202.6s | 39 nodes with prose |
| **Total** | ~211s | |

- Nodes created: 29 file, 57 function, 10 module (96 total)
- Nodes with prose: 39 (files + modules only)
- Estimated cost: ~$0.50-1.00 (qwen-turbo pricing)

## Task Results

### Task 1: Architecture
**Question**: "How do the CLI commands (extract, build, generate) orchestrate the pipeline stages?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 4/5 | 5/5 |
| Completeness | 3/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 3/5 | 5/5 |
| **Total** | 19/25 | 24/25 |

- **Winner**: Control
- **Pith tokens**: ~1,755
- **Control tokens**: ~21,500
- **Notes**: Pith provided module-level summaries describing data flow generically. Control found exact command implementations: extract's 4-function sequence (extractFile → extractGitInfo → extractDocs → storeExtracted), build's 7-step pipeline with edge builders, and generate's node iteration with LLM calls at specific line numbers.

---

### Task 2: Specific Behavior
**Question**: "What is the retry logic in the LLM client and what triggers a retry?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 2/5 | 5/5 |
| Completeness | 1/5 | 5/5 |
| Accuracy | 5/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 1/5 | 5/5 |
| **Total** | 14/25 | 24/25 |

- **Winner**: Control
- **Pith tokens**: ~246
- **Control tokens**: ~650
- **Notes**: Pith provided only a module-level overview with no retry specifics. Control found: isRetryableError() (lines 513-532) checking for 429/5xx/AbortError/network errors, maxRetries=3 (line 546), exponential backoff of 2^attempt * 1000ms (lines 599, 625), and 30-second timeout (line 547).

---

### Task 3: Cross-Module Relationship
**Question**: "How does data flow from AST extraction through to the final wiki output?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 4/5 | 5/5 |
| Completeness | 3/5 | 5/5 |
| Accuracy | 5/5 | 5/5 |
| Efficiency | 5/5 | 3/5 |
| Actionability | 3/5 | 5/5 |
| **Total** | 20/25 | 23/25 |

- **Winner**: Control
- **Pith tokens**: ~1,180
- **Control tokens**: ~1,950
- **Notes**: Pith described module purposes separately but not transformations. Control traced: ExtractedFile creation at ast.ts:305 → WikiNode building at builder/index.ts:77 → ProseData generation at generator/index.ts:266 with specific functions (buildFileNode, buildPrompt, parseLLMResponse) and interfaces.

---

### Task 4: Debugging
**Question**: "Build command completes but some nodes have no prose. What could cause this?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 3/5 | 5/5 |
| Completeness | 2/5 | 5/5 |
| Accuracy | 4/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 2/5 | 5/5 |
| **Total** | 16/25 | 24/25 |

- **Winner**: Control
- **Pith tokens**: ~390
- **Control tokens**: ~520
- **Notes**: Pith mentioned data flows but not node type handling. Control identified three causes: (1) buildPrompt() only supports 'file'/'module' types (lines 80-87), (2) CLI filters to only file/module nodes (lines 575-577), (3) silent error handling catches failures without blocking (lines 609-618).

---

### Task 5: Modification
**Question**: "I want to add support for extracting JSDoc comments. What files need changes?"

| Criterion | Pith | Control |
|-----------|------|---------|
| Relevance | 2/5 | 5/5 |
| Completeness | 1/5 | 5/5 |
| Accuracy | 5/5 | 5/5 |
| Efficiency | 5/5 | 4/5 |
| Actionability | 1/5 | 5/5 |
| **Total** | 14/25 | 24/25 |

- **Winner**: Control
- **Pith tokens**: ~260
- **Control tokens**: ~2,700
- **Notes**: Pith listed extractor files with no JSDoc specifics. Control discovered JSDoc extraction is ALREADY IMPLEMENTED in docs.ts (lines 71-200) with complete @param, @returns, @throws, @deprecated parsing. Identified 4 integration points: docs.ts, ast.ts (line 108), builder/index.ts (lines 195-198), cli/index.ts (line 186).

---

## Summary

| Metric | Pith | Control |
|--------|------|---------|
| Average score | 16.6/25 | 23.8/25 |
| Win/Loss/Tie | 0-5-0 | 5-0-0 |

### Score Breakdown by Criterion

| Criterion | Pith Avg | Control Avg |
|-----------|----------|-------------|
| Relevance | 3.0 | 5.0 |
| Completeness | 2.0 | 5.0 |
| Accuracy | 4.6 | 5.0 |
| Efficiency | 5.0 | 3.8 |
| Actionability | 2.0 | 5.0 |

### Comparison to Previous Runs

| Metric | v1 (12/30) | v2 (12/30) | v3 (12/30) | Change |
|--------|------------|------------|------------|--------|
| Pith Average | 12.6/25 | 12.6/25 | 16.6/25 | **+4.0** |
| Control Average | 24.2/25 | 24.4/25 | 23.8/25 | -0.4 |
| Pith Relevance | 2.4 | 2.6 | 3.0 | **+0.4** |
| Pith Completeness | 1.8 | 1.8 | 2.0 | **+0.2** |
| Pith Accuracy | 3.6 | 3.6 | 4.6 | **+1.0** |
| Pith Efficiency | 3.0 | 2.8 | 5.0 | **+2.0** |
| Pith Actionability | 1.8 | 1.8 | 2.0 | **+0.2** |

**Notable Improvement**: Pith average increased by 4 points from 12.6 to 16.6. The main gains are in:
- **Efficiency** (+2.0): Prose is more concise and focused
- **Accuracy** (+1.0): Information is more correct
- **Relevance** (+0.4): Better targeting of relevant content

---

## Information Gap Analysis

### Information Type Comparison

| Information Type | Pith | Control | Gap Severity |
|------------------|:----:|:-------:|:------------:|
| Module/file names | ✅ | ✅ | None |
| One-line summary | ✅ | ✅ | None |
| Purpose description | ✅ | ✅ | Minor |
| Gotchas/warnings | ⚠️ Generic | ✅ Specific | **High** |
| Key exports list | ✅ | ✅ | None |
| Import relationships | ✅ | ✅ | Minor |
| Fan-in/fan-out metrics | ✅ | ❌ | None (Pith advantage) |
| Git metadata | ✅ | ❌ | None (Pith advantage) |
| **Line numbers** | ⚠️ Partial | ✅ | **Medium** |
| **Code snippets** | ⚠️ Partial | ✅ | **Medium** |
| **Function signatures** | ✅ | ✅ | Minor |
| Specific variable/config values | ❌ | ✅ | **High** |
| Implementation details | ❌ | ✅ | **Critical** |
| Error handling logic | ❌ | ✅ | **High** |
| Data flow explanation | ⚠️ Generic | ✅ Specific | **High** |
| Priority/criticality ranking | ❌ | ✅ | Medium |
| Test file locations | ✅ | ✅ | None |
| Suggested changes | ❌ | ✅ | **High** |

### Improvements Since Previous Runs

1. **Pith Efficiency increased significantly** - Prose is now more concise (5.0 vs 2.8-3.0)
2. **Accuracy improved** - Module descriptions are more correct (4.6 vs 3.6)
3. **Still missing implementation depth** - The gap remains for specific line numbers, code snippets in context, and implementation details

### Concrete Example: Task 2 (Retry Logic)

| Detail | Pith Said | Control Said | Gap |
|--------|-----------|--------------|-----|
| Retry exists? | "Generator module uses LLMs" | "maxRetries = 3 at line 546" | **Missing specifics** |
| What triggers retry? | Not mentioned | "429, 5xx, AbortError, network errors" | **Missing entirely** |
| Backoff timing? | Not mentioned | "2^attempt * 1000ms (lines 599, 625)" | **Missing entirely** |
| Timeout value? | Not mentioned | "30 seconds (line 547)" | **Missing entirely** |

### Concrete Example: Task 5 (JSDoc)

| Detail | Pith Said | Control Said | Gap |
|--------|-----------|--------------|-----|
| JSDoc support? | "docs.ts handles documentation" | "Full JSDoc implemented at lines 71-200" | **Critical context** |
| Tag support? | Not mentioned | "@param, @returns, @throws, @deprecated, @examples, @see" | **Missing entirely** |
| Integration points? | Not mentioned | "4 files: docs.ts, ast.ts:108, builder:195-198, cli:186" | **Missing entirely** |

---

## Key Observations

### Pith's Strengths (Improved)
1. **Excellent efficiency** (5.0/5) - Prose is focused and not bloated
2. **Good accuracy** (4.6/5) - Information is generally correct
3. **Fast retrieval** - Context returned instantly once wiki built
4. **Better relevance** (3.0 vs 2.4) - More targeted to query topics

### Pith's Persistent Weaknesses
1. **No implementation synthesis** - Can't explain how pieces connect with specifics
2. **Missing specific values** - Retry counts, timeouts, formulas not captured
3. **No cross-file tracing** - Can't follow data transformations across modules
4. **Gotchas too generic** - "error handling may need extending" vs "400 errors don't retry at line 533"

### Why Control Still Wins

Control's advantage isn't just information depth - it's the ability to:
1. **Discover unexpected facts** (JSDoc already implemented)
2. **Trace specific code paths** (retry logic at exact lines)
3. **Identify root causes** (function nodes skipped in prose generation)
4. **Provide actionable locations** (exact files and line numbers for changes)

---

## Recommendations for Next Phase

### Priority 1: Enhance Implementation Detail Capture
- Include specific values from code (retry counts, timeouts, thresholds)
- Add code snippet context to prose generation prompts
- Capture error handling patterns and edge cases

### Priority 2: Improve Cross-Module Synthesis
- Add data flow tracing between modules
- Explain transformations between data structures
- Connect related files with specific function calls

### Priority 3: Make Gotchas Actionable
- Include line numbers in gotcha warnings
- Specify exact conditions and values
- Provide debugging guidance with specific files

---

## Revision History

| Date | Change | Author |
|------|--------|--------|
| 2025-12-30 | Third benchmark run with new tasks | Claude |
| 2025-12-30 | Added comparison to previous runs showing +4 point improvement | Claude |
